


```mermaid
flowchart LR
    %% ===== L1: Ingestion =====
    subgraph L1[ğŸ” Data Ingestion]
        DS[[ğŸ›¢ï¸ Datastream<br>ï¼ˆFull load ï¼† CDCï¼‰]]:::ing
        DFUS[[ğŸ§ª Data Fusion ï¼ Storage Transfer<br>ï¼ˆBatch filesï¼ingestï¼‰]]:::ing
        PS[[ğŸ“¡ Pub/Sub ï¼ Confluent Cloud<br>ï¼ˆStreaming eventsï¼‰]]:::ing
    end

    %% ===== L2: Processing =====
    subgraph L2[âš™ï¸ Data Processing]
        DF[[ğŸ§ª Dataflow<br>ï¼ˆBeamï¼Serverlessï¼Œæ‰¹ï¼æµï¼‰]]:::proc
        DP[[ğŸ—ºï¸ Dataproc<br>ï¼ˆSparkï¼Hiveï¼Hadoopï¼‰]]:::proc
        CFX[[âš¡ Dataflowï¼ˆStreamingï¼‰<br>ï¼ˆFlinkï¼Beam æµå¼ï¼‰]]:::proc
        CFN[[Î» Cloud Functions<br>ï¼ˆè½»é‡æµå¼å˜æ¢ï¼‰]]:::proc
    end

    %% ===== L3: Lake Storage Zones =====
    subgraph L3[ğŸ—ƒï¸ Data Lakeï¼ˆGCS Zonesï¼‰]
        RAW[(ğŸª£ Cloud Storage<br>ï¼ˆRaw zoneï¼‰)]:::stor
        STG[(ğŸª£ Cloud Storage<br>ï¼ˆStaging zoneï¼‰)]:::stor
        CUR[(ğŸª£ Cloud Storage<br>ï¼ˆCurated zoneï¼‰)]:::stor
    end

    %% ===== L3.5: Warehouse =====
    subgraph L35[ğŸ›ï¸ Warehouse]
        BQ[(BigQuery<br>ï¼ˆAnalytics warehouseï¼‰)]:::wh
    end

    %% ===== L4: Serving ï¼† Analytics =====
    subgraph L4[ğŸ“Š Serving ï¼† Analytics]
        BQX[[ğŸ” BigQuery External Tables<br>ï¼ˆSQL on GCSï¼‰]]:::srv
        LS[[ğŸ“ˆ Looker Studio ï¼ Looker<br>ï¼ˆDashboardsï¼‰]]:::srv
        API[[ğŸ”Œ API Gateway ï¼† Cloud Run<br>ï¼ˆData APIsï¼‰]]:::srv
        ES[[ğŸ” Elastic Cloudï¼ˆElasticsearchï¼‰<br>ï¼ˆSearchï¼Logsï¼‰]]:::srv
        VAI[[ğŸ¤– Vertex AI<br>ï¼ˆML trainingï¼inferenceï¼‰]]:::srv
    end

    %% ===== Governanceï¼ˆMetadata ï¼† Access Controlï¼‰ =====
    subgraph GOV[ğŸ—‚ï¸ Governance]
        DPX[[ğŸ“š Dataplex ï¼† Data Catalog<br>ï¼ˆSchemasï¼Tablesï¼Permissionsï¼‰]]:::gov
    end

    %% ===== Batch core =====
    DS --> RAW
    DFUS --> RAW
    RAW --> DF
    RAW --> DP
    DF --> STG
    DP --> STG
    STG --> DF
    DF --> CUR
    DP --> CUR
    CUR --> BQ

    %% ===== Streaming core =====
    PS -.-> CFX
    PS -.-> CFN
    CFX -.-> STG
    CFN -.-> STG
    CFX -.-> BQ

    %% ===== Serving =====
    CUR --> BQX
    BQ --> LS
    CUR -.-> ES
    BQ -.-> API
    CUR -.-> VAI

    %% ===== Streaming â†’ Serving directï¼ˆfor real-time use casesï¼‰ =====
    CFX -.-> ES
    CFN -.-> API

    %% ===== Governance wiringï¼ˆdashedï¼‰ =====
    DPX -.-> RAW
    DPX -.-> STG
    DPX -.-> CUR
    DPX -.-> BQ

    %% ===== Optional source hint =====
    SQL[(ğŸ—„ï¸ Cloud SQL ï¼ AlloyDB<br>ï¼ˆOLTP sourceï¼‰)]:::src
    SQL -.-> DS

    %% ===== Styles =====
    classDef ing  fill:#d0f0fd,stroke:#007acc,stroke-width:2px,rx:10,ry:10;
    classDef proc fill:#e6d0fd,stroke:#7e3ff2,stroke-width:2px,rx:10,ry:10;
    classDef stor fill:#fde2d0,stroke:#cc5200,stroke-width:2px,rx:10,ry:10;
    classDef wh   fill:#ffe8b3,stroke:#aa7a00,stroke-width:2px,rx:10,ry:10;
    classDef srv  fill:#d9f7be,stroke:#237804,stroke-width:2px,rx:10,ry:10;
    classDef gov  fill:#f0f5ff,stroke:#2f54eb,stroke-width:2px,rx:10,ry:10;
    classDef src  fill:#fff1f0,stroke:#cf1322,stroke-width:2px,rx:10,ry:10;

```